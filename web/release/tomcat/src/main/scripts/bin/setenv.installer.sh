
# =======================================================
# Jeyzer Web Server variables
# 
# Jeyzer Web uses JEYZER_WEB variable prefix 
# Jeyzer Analyzer uses JEYZER_ANALYZER variable prefix 
# =======================================================

# Jeyzer variables
JEYZER_WEB_ANALYZER_WORK_DIR="%{jeyzer.analyzer.work.dir}/web/analysis"
export JEYZER_WEB_ANALYZER_WORK_DIR

# Factory directories
JEYZER_ANALYZER_CONFIG_DIR="%{INSTALL_PATH}/analyzer/config"
export JEYZER_ANALYZER_CONFIG_DIR

# Profile directories
JEYZER_EXTERNAL_MASTER_PROFILES_DIR="%{jeyzer.analyzer.ext.profiles.dir}/master"
export JEYZER_EXTERNAL_MASTER_PROFILES_DIR
JEYZER_EXTERNAL_SHARED_PROFILES_DIR="%{jeyzer.analyzer.ext.profiles.dir}/shared"
export JEYZER_EXTERNAL_SHARED_PROFILES_DIR

JEYZER_BASE_MASTER_PROFILES_DIR="%{INSTALL_PATH}/profiles/base/master"
export JEYZER_BASE_MASTER_PROFILES_DIR
JEYZER_BASE_SHARED_PROFILES_DIR="%{INSTALL_PATH}/profiles/base/shared"
export JEYZER_BASE_SHARED_PROFILES_DIR
JEYZER_BASE_HELPER_PROFILES_DIR="%{INSTALL_PATH}/profiles/base/helper"
export JEYZER_BASE_HELPER_PROFILES_DIR

JEYZER_DEMO_MASTER_PROFILES_DIR="%{INSTALL_PATH}/profiles/demo/master"
export JEYZER_DEMO_MASTER_PROFILES_DIR
JEYZER_DEMO_SHARED_PROFILES_DIR="%{INSTALL_PATH}/profiles/demo/shared"
export JEYZER_DEMO_SHARED_PROFILES_DIR

# Master profile root directories
JEYZER_MASTER_PROFILES_DIR_ROOTS=$JEYZER_EXTERNAL_MASTER_PROFILES_DIR:$JEYZER_DEMO_MASTER_PROFILES_DIR:$JEYZER_BASE_MASTER_PROFILES_DIR:$JEYZER_BASE_HELPER_PROFILES_DIR
export JEYZER_MASTER_PROFILES_DIR_ROOTS

# External place where the Jeyzer shared repositories are declared
JEYZER_EXTERNAL_REPOSITORY_SETUP_DIRECTORY="%{INSTALL_PATH}/profiles/shared-repositories"
export JEYZER_EXTERNAL_REPOSITORY_SETUP_DIRECTORY

# Deobfuscation
JEYZER_DEOBSFUCATION_CONFIG_DIR="%{jeyzer.analyzer.deobfuscation.dir}"
export JEYZER_DEOBSFUCATION_CONFIG_DIR
JEYZER_ANALYZER_KEEP_DEOBFUSCATED_FILES=true
export JEYZER_ANALYZER_KEEP_DEOBFUSCATED_FILES
JEYZER_REPOSITORY_MANAGER_URL=http://localhost:8080 
export JEYZER_REPOSITORY_MANAGER_URL

# Report
JEYZER_JZR_REPORT_ENABLED=true
export JEYZER_JZR_REPORT_ENABLED
JEYZER_ANALYZER_TEAM_EMAIL_ENABLED=false
export JEYZER_ANALYZER_TEAM_EMAIL_ENABLED

# Monitor
JEYZER_MONITOR_ANALYZER_STICKERS="code_quality, performance, security, environment, analysis"
export JEYZER_MONITOR_ANALYZER_STICKERS

# Replay
JEYZER_ANALYZER_REPLAY_ENABLED=false
export JEYZER_ANALYZER_REPLAY_ENABLED
JEYZER_GRAPH_REFRESH_PERIOD=3s
export JEYZER_GRAPH_REFRESH_PERIOD
JEYZER_DYNAMIC_GRAPH_MODE=action_single
export JEYZER_DYNAMIC_GRAPH_MODE
JEYZER_ANALYZER_GRAPH_VIEWER_ENABLED=$JEYZER_ANALYZER_REPLAY_ENABLED
export JEYZER_ANALYZER_GRAPH_VIEWER_ENABLED

# Logging
JEYZER_WEB_ANALYZER_LOG_DIR="%{INSTALL_PATH}/analyzer/log"
export JEYZER_WEB_ANALYZER_LOG_DIR

# Java core
JEYZER_WEB_DEBUG=true
export JEYZER_WEB_DEBUG
JAVA_OPTS="$JAVA_OPTS -Xmx2048m -Xms512m -Dlogback.configurationFile=%{INSTALL_PATH}/analyzer/config/log/web-analyzer-logback.xml"
export JAVA_OPTS

# Web parameters
#  Max file size in Mb
# JEYZER_WEB_UPLOAD_RECORDING_MAX_SIZE=10
# export JEYZER_WEB_UPLOAD_RECORDING_MAX_SIZE
# JEYZER_WEB_UPLOAD_RECORDING_UNCOMPRESSED_MAX_SIZE=150
# export JEYZER_WEB_UPLOAD_RECORDING_UNCOMPRESSED_MAX_SIZE
#  3 hours for a 30 sec period recording
# JEYZER_WEB_UPLOAD_RECORDING_UNCOMPRESSED_MAX_FILES=362
# export JEYZER_WEB_UPLOAD_RECORDING_UNCOMPRESSED_MAX_FILES
# JEYZER_WEB_ANALYZER_THREAD_POOL_SIZE=3
# export JEYZER_WEB_ANALYZER_THREAD_POOL_SIZE
# JEYZER_WEB_DISPLAY_UFO_STACK_FILE_LINK=true
# export JEYZER_WEB_DISPLAY_UFO_STACK_FILE_LINK
# JEYZER_WEB_DISPLAY_FUNCTION_DISCOVERY=true
# export JEYZER_WEB_DISPLAY_FUNCTION_DISCOVERY
JEYZER_WEB_TEMP_UPLOAD_DIRECTORY=%{jeyzer.analyzer.work.dir}/web/upload
export JEYZER_WEB_TEMP_UPLOAD_DIRECTORY
JEYZER_WEB_TEMP_UPLOAD_RECORDING_MAX_RETENTION_TIME=5m
export JEYZER_WEB_TEMP_UPLOAD_RECORDING_MAX_RETENTION_TIME

# Set the portal variables if required
if [ -r "$CATALINA_HOME"/bin/setenv-portal.sh ]; then
  . "$CATALINA_HOME"/bin/setenv-portal.sh
fi